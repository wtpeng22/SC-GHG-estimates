dim(SC_Fair_PAGE_N2O) = c(run_time*Ds_num,1)
SC_Fair_DICE_CO2 = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/rffsps/SC_CO2_total_Fair_DICE.csv"));
SC_Fair_DICE_CH4 = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/rffsps/SC_CH4_total_Fair_DICE.csv"));
SC_Fair_DICE_N2O = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/rffsps/SC_N2O_total_Fair_DICE.csv"));
dim(SC_Fair_DICE_CO2) = c(run_time*Ds_num,1)
dim(SC_Fair_DICE_CH4) = c(run_time*Ds_num,1)
dim(SC_Fair_DICE_N2O) = c(run_time*Ds_num,1)
SC_Fair_DICE_CO2_level = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/rffsps/SC_CO2_level_Fair_DICE.csv"));
SC_Fair_DICE_CH4_level = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/rffsps/SC_CH4_level_Fair_DICE.csv"));
SC_Fair_DICE_N2O_level = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/rffsps/SC_N2O_level_Fair_DICE.csv"));
dim(SC_Fair_DICE_CO2_level) = c(run_time*Ds_num,1)
dim(SC_Fair_DICE_CH4_level) = c(run_time*Ds_num,1)
dim(SC_Fair_DICE_N2O_level) = c(run_time*Ds_num,1)
SC_Fair_Howard_CO2 = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/rffsps/SC_CO2_total_Fair_Howard.csv"));
SC_Fair_Howard_CH4 = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/rffsps/SC_CH4_total_Fair_Howard.csv"));
SC_Fair_Howard_N2O = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/rffsps/SC_N2O_total_Fair_Howard.csv"));
dim(SC_Fair_Howard_CO2) = c(run_time*Ds_num,1)
dim(SC_Fair_Howard_CH4) = c(run_time*Ds_num,1)
dim(SC_Fair_Howard_N2O) = c(run_time*Ds_num,1)
SC_Fair_Howard_CO2_level = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/rffsps/SC_CO2_level_Fair_Howard.csv"));
SC_Fair_Howard_CH4_level = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/rffsps/SC_CH4_level_Fair_Howard.csv"));
SC_Fair_Howard_N2O_level = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/rffsps/SC_N2O_level_Fair_Howard.csv"));
dim(SC_Fair_Howard_CO2_level) = c(run_time*Ds_num,1)
dim(SC_Fair_Howard_CH4_level) = c(run_time*Ds_num,1)
dim(SC_Fair_Howard_N2O_level) = c(run_time*Ds_num,1)
## SC_GHG from MAGICC model
SC_MAGICC_DJO_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DJO/rffsps/WSC_CO2_MAGICC_DJO.csv"));
SC_MAGICC_DJO_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DJO/rffsps/WSC_CH4_MAGICC_DJO.csv"));
SC_MAGICC_DJO_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DJO/rffsps/WSC_N2O_MAGICC_DJO.csv"));
dim(SC_MAGICC_DJO_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DJO_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DJO_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_BHM_lag0_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/rffsps/lag0/WSC_CO2_MAGICC_BHM.csv"));
SC_MAGICC_BHM_lag0_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/rffsps/lag0/WSC_CH4_MAGICC_BHM.csv"));
SC_MAGICC_BHM_lag0_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/rffsps/lag0/WSC_N2O_MAGICC_BHM.csv"));
dim(SC_MAGICC_BHM_lag0_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_BHM_lag0_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_BHM_lag0_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_BHM_lag5_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/rffsps/lag5/WSC_CO2_MAGICC_BHM.csv"));
SC_MAGICC_BHM_lag5_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/rffsps/lag5/WSC_CH4_MAGICC_BHM.csv"));
SC_MAGICC_BHM_lag5_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/rffsps/lag5/WSC_N2O_MAGICC_BHM.csv"));
dim(SC_MAGICC_BHM_lag5_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_BHM_lag5_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_BHM_lag5_N2O) = c(run_time*Ds_num,1)
#
# SC_MAGICC_KW_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_KW/rffsps/WSC_CO2_MAGICC_KW.csv"));
# SC_MAGICC_KW_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_KW/rffsps/WSC_CH4_MAGICC_KW.csv"));
# SC_MAGICC_KW_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_KW/rffsps/WSC_N2O_MAGICC_KW.csv"));
#
# dim(SC_MAGICC_KW_CO2) = c(run_time*Ds_num,1)
# dim(SC_MAGICC_KW_CH4) = c(run_time*Ds_num,1)
# dim(SC_MAGICC_KW_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_FUND_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_FUND/rffsps/SC_CO2_MAGICC_FUND.csv"))*1.46;
SC_MAGICC_FUND_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_FUND/rffsps/SC_CH4_MAGICC_FUND.csv"))*1.46;
SC_MAGICC_FUND_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_FUND/rffsps/SC_N2O_MAGICC_FUND.csv"))*1.46;
dim(SC_MAGICC_FUND_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_FUND_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_FUND_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_PAGE_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_PAGE/rffsps/SC_CO2_MAGICC_PAGE.csv"))*1.20;
SC_MAGICC_PAGE_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_PAGE/rffsps/SC_CH4_MAGICC_PAGE.csv"))*1.20;
SC_MAGICC_PAGE_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_PAGE/rffsps/SC_N2O_MAGICC_PAGE.csv"))*1.20;
dim(SC_MAGICC_PAGE_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_PAGE_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_PAGE_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_DICE_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/rffsps/SC_CO2_total_MAGICC_DICE.csv"));
SC_MAGICC_DICE_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/rffsps/SC_CH4_total_MAGICC_DICE.csv"));
SC_MAGICC_DICE_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/rffsps/SC_N2O_total_MAGICC_DICE.csv"));
dim(SC_MAGICC_DICE_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DICE_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DICE_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_DICE_CO2_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/rffsps/SC_CO2_level_MAGICC_DICE.csv"));
SC_MAGICC_DICE_CH4_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/rffsps/SC_CH4_level_MAGICC_DICE.csv"));
SC_MAGICC_DICE_N2O_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/rffsps/SC_N2O_level_MAGICC_DICE.csv"));
dim(SC_MAGICC_DICE_CO2_level) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DICE_CH4_level) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DICE_N2O_level) = c(run_time*Ds_num,1)
SC_MAGICC_Howard_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/rffsps/SC_CO2_total_MAGICC_Howard.csv"));
SC_MAGICC_Howard_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/rffsps/SC_CH4_total_MAGICC_Howard.csv"));
SC_MAGICC_Howard_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/rffsps/SC_N2O_total_MAGICC_Howard.csv"));
dim(SC_MAGICC_Howard_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_Howard_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_Howard_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_Howard_CO2_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/rffsps/SC_CO2_level_MAGICC_Howard.csv"));
SC_MAGICC_Howard_CH4_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/rffsps/SC_CH4_level_MAGICC_Howard.csv"));
SC_MAGICC_Howard_N2O_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/rffsps/SC_N2O_level_MAGICC_Howard.csv"));
dim(SC_MAGICC_Howard_CO2_level) = c(run_time*Ds_num,1)
dim(SC_MAGICC_Howard_CH4_level) = c(run_time*Ds_num,1)
dim(SC_MAGICC_Howard_N2O_level) = c(run_time*Ds_num,1)
## SC_GHG from Hector model
SC_Hector_DJO_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_DJO/rffsps/WSC_CO2_Hector_DJO.csv"));
SC_Hector_DJO_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_DJO/rffsps/WSC_CH4_Hector_DJO.csv"));
SC_Hector_DJO_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_DJO/rffsps/WSC_N2O_Hector_DJO.csv"));
dim(SC_Hector_DJO_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_DJO_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_DJO_N2O) = c(run_time*Ds_num,1)
SC_Hector_BHM_lag0_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/rffsps/lag0/WSC_CO2_Hector_BHM.csv"));
SC_Hector_BHM_lag0_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/rffsps/lag0/WSC_CH4_Hector_BHM.csv"));
SC_Hector_BHM_lag0_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/rffsps/lag0/WSC_N2O_Hector_BHM.csv"));
dim(SC_Hector_BHM_lag0_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_BHM_lag0_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_BHM_lag0_N2O) = c(run_time*Ds_num,1)
SC_Hector_BHM_lag5_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/rffsps/lag5/WSC_CO2_Hector_BHM.csv"));
SC_Hector_BHM_lag5_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/rffsps/lag5/WSC_CH4_Hector_BHM.csv"));
SC_Hector_BHM_lag5_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/rffsps/lag5/WSC_N2O_Hector_BHM.csv"));
dim(SC_Hector_BHM_lag5_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_BHM_lag5_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_BHM_lag5_N2O) = c(run_time*Ds_num,1)
#
# SC_Hector_KW_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_KW/rffsps/WSC_CO2_Hector_KW.csv"));
# SC_Hector_KW_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_KW/rffsps/WSC_CH4_Hector_KW.csv"));
# SC_Hector_KW_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_KW/rffsps/WSC_N2O_Hector_KW.csv"));
#
# dim(SC_Hector_KW_CO2) = c(run_time*Ds_num,1)
# dim(SC_Hector_KW_CH4) = c(run_time*Ds_num,1)
# dim(SC_Hector_KW_N2O) = c(run_time*Ds_num,1)
SC_Hector_FUND_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_FUND/rffsps/SC_CO2_Hector_FUND.csv"))*1.46;
SC_Hector_FUND_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_FUND/rffsps/SC_CH4_Hector_FUND.csv"))*1.46;
SC_Hector_FUND_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_FUND/rffsps/SC_N2O_Hector_FUND.csv"))*1.46;
dim(SC_Hector_FUND_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_FUND_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_FUND_N2O) = c(run_time*Ds_num,1)
SC_Hector_PAGE_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_PAGE/rffsps/SC_CO2_Hector_PAGE.csv"))*1.20;
SC_Hector_PAGE_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_PAGE/rffsps/SC_CH4_Hector_PAGE.csv"))*1.20;
SC_Hector_PAGE_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_PAGE/rffsps/SC_N2O_Hector_PAGE.csv"))*1.20;
dim(SC_Hector_PAGE_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_PAGE_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_PAGE_N2O) = c(run_time*Ds_num,1)
SC_Hector_DICE_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/rffsps/SC_CO2_total_Hector_DICE.csv"));
SC_Hector_DICE_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/rffsps/SC_CH4_total_Hector_DICE.csv"));
SC_Hector_DICE_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/rffsps/SC_N2O_total_Hector_DICE.csv"));
dim(SC_Hector_DICE_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_DICE_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_DICE_N2O) = c(run_time*Ds_num,1)
SC_Hector_DICE_CO2_level = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/rffsps/SC_CO2_level_Hector_DICE.csv"));
SC_Hector_DICE_CH4_level = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/rffsps/SC_CH4_level_Hector_DICE.csv"));
SC_Hector_DICE_N2O_level = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/rffsps/SC_N2O_level_Hector_DICE.csv"));
dim(SC_Hector_DICE_CO2_level) = c(run_time*Ds_num,1)
dim(SC_Hector_DICE_CH4_level) = c(run_time*Ds_num,1)
dim(SC_Hector_DICE_N2O_level) = c(run_time*Ds_num,1)
SC_Hector_Howard_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/rffsps/SC_CO2_total_Hector_Howard.csv"));
SC_Hector_Howard_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/rffsps/SC_CH4_total_Hector_Howard.csv"));
SC_Hector_Howard_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/rffsps/SC_N2O_total_Hector_Howard.csv"));
dim(SC_Hector_Howard_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_Howard_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_Howard_N2O) = c(run_time*Ds_num,1)
SC_Hector_Howard_CO2_level = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/rffsps/SC_CO2_level_Hector_Howard.csv"));
SC_Hector_Howard_CH4_level = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/rffsps/SC_CH4_level_Hector_Howard.csv"));
SC_Hector_Howard_N2O_level = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/rffsps/SC_N2O_level_Hector_Howard.csv"));
dim(SC_Hector_Howard_CO2_level) = c(run_time*Ds_num,1)
dim(SC_Hector_Howard_CH4_level) = c(run_time*Ds_num,1)
dim(SC_Hector_Howard_N2O_level) = c(run_time*Ds_num,1)
## Construct the data frame for methane
IAMs_SC_CH4 = matrix(nrow = run_time*Climate_num*Damage_num*Ds_num,ncol = 4);
IAMs_SC_CH4[,1] = rep(Clim_total,each = run_time*Damage_num*Ds_num);
IAMs_SC_CH4[,2] = rep(rep(Dam_nolevel[1:Damage_num],each = run_time*Ds_num),Climate_num);
IAMs_SC_CH4[,3] = rep(rep(Ds_total,each = run_time),Climate_num*Damage_num);
IAMs_SC_CH4[,4] = c(SC_Fair_BHM_lag0_CH4,SC_Fair_BHM_lag5_CH4,SC_Fair_DJO_CH4,SC_Fair_DICE_CH4,SC_Fair_Howard_CH4,SC_Fair_FUND_CH4,SC_Fair_PAGE_CH4,
SC_MAGICC_BHM_lag0_CH4,SC_MAGICC_BHM_lag5_CH4,SC_MAGICC_DJO_CH4,SC_MAGICC_DICE_CH4,SC_MAGICC_Howard_CH4,SC_MAGICC_FUND_CH4,SC_MAGICC_PAGE_CH4,
SC_Hector_BHM_lag0_CH4,SC_Hector_BHM_lag5_CH4,SC_Hector_DJO_CH4,SC_Hector_DICE_CH4,SC_Hector_Howard_CH4,SC_Hector_FUND_CH4,SC_Hector_PAGE_CH4);
IAMs_SC_CH4 = as.data.frame(IAMs_SC_CH4)
colnames(IAMs_SC_CH4) = c("Climate_models","Damage_models","Ds","SC_GHG");
IAMs_SC_CH4$SC_GHG = as.numeric(as.character(IAMs_SC_CH4$SC_GHG))
IAMs_SC_CH4=as.data.table(IAMs_SC_CH4);
IAMs_SC_CH4_quantile <- IAMs_SC_CH4[,c(mean(SC_GHG)),by=c("Ds")]
IAMs_SC_CH4_quantile <- IAMs_SC_CH4_quantile %>%
dplyr::mutate(y.min = IAMs_SC_CH4[,c(quantile(SC_GHG,0.05)),by=c("Ds")]$V1,
y.likelymin = IAMs_SC_CH4[,c(quantile(SC_GHG,0.167)),by=c("Ds")]$V1,
y.low = IAMs_SC_CH4[,c(quantile(SC_GHG,0.25)),by=c("Ds")]$V1,
y.mid = IAMs_SC_CH4[,c(quantile(SC_GHG,0.5)),by=c("Ds")]$V1,
y.high = IAMs_SC_CH4[,c(quantile(SC_GHG,0.75)),by=c("Ds")]$V1,
y.likelymax = IAMs_SC_CH4[,c(quantile(SC_GHG,0.833)),by=c("Ds")]$V1,
y.max = IAMs_SC_CH4[,c(quantile(SC_GHG,0.95)),by=c("Ds")]$V1)
IAMs_SC_CH4_climate_damage_quantile <- IAMs_SC_CH4[,c(mean(SC_GHG)),by=c("Ds","Climate_models","Damage_models")]
IAMs_SC_CH4_climate_damage_quantile <- IAMs_SC_CH4_climate_damage_quantile %>%
dplyr::mutate(y.min = IAMs_SC_CH4[,c(quantile(SC_GHG,0.05)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.likelymin = IAMs_SC_CH4[,c(quantile(SC_GHG,0.167)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.low = IAMs_SC_CH4[,c(quantile(SC_GHG,0.25)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.mid = IAMs_SC_CH4[,c(quantile(SC_GHG,0.5)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.mean = IAMs_SC_CH4[,c(mean(SC_GHG)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.high = IAMs_SC_CH4[,c(quantile(SC_GHG,0.75)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.likelymax = IAMs_SC_CH4[,c(quantile(SC_GHG,0.833)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.max = IAMs_SC_CH4[,c(quantile(SC_GHG,0.95)),by=c("Ds","Climate_models","Damage_models")]$V1)
## Construct the data frame for N2O
IAMs_SC_N2O = matrix(nrow = run_time*Climate_num*Damage_num*Ds_num,ncol = 4);
IAMs_SC_N2O[,1] = rep(Clim_total,each = run_time*Damage_num*Ds_num);
IAMs_SC_N2O[,2] = rep(rep(Dam_nolevel[1:Damage_num],each = run_time*Ds_num),Climate_num);
IAMs_SC_N2O[,3] = rep(rep(Ds_total,each = run_time),Climate_num*Damage_num);
IAMs_SC_N2O[,4] = c(SC_Fair_BHM_lag0_N2O,SC_Fair_BHM_lag5_N2O,SC_Fair_DJO_N2O,SC_Fair_DICE_N2O,SC_Fair_Howard_N2O,SC_Fair_FUND_N2O,SC_Fair_PAGE_N2O,
SC_MAGICC_BHM_lag0_N2O,SC_MAGICC_BHM_lag5_N2O,SC_MAGICC_DJO_N2O,SC_MAGICC_DICE_N2O,SC_MAGICC_Howard_N2O,SC_MAGICC_FUND_N2O,SC_MAGICC_PAGE_N2O,
SC_Hector_BHM_lag0_N2O,SC_Hector_BHM_lag5_N2O,SC_Hector_DJO_N2O,SC_Hector_DICE_N2O,SC_Hector_Howard_N2O,SC_Hector_FUND_N2O,SC_Hector_PAGE_N2O);
IAMs_SC_N2O = as.data.frame(IAMs_SC_N2O)
colnames(IAMs_SC_N2O) = c("Climate_models","Damage_models","Ds","SC_GHG");
IAMs_SC_N2O$SC_GHG = as.numeric(as.character(IAMs_SC_N2O$SC_GHG))
IAMs_SC_N2O=as.data.table(IAMs_SC_N2O);
IAMs_SC_N2O_quantile <- IAMs_SC_N2O[,c(mean(SC_GHG)),by=c("Ds")]
IAMs_SC_N2O_quantile <- IAMs_SC_N2O_quantile %>%
dplyr::mutate(y.min = IAMs_SC_N2O[,c(quantile(SC_GHG,0.05)),by=c("Ds")]$V1,
y.likelymin = IAMs_SC_N2O[,c(quantile(SC_GHG,0.167)),by=c("Ds")]$V1,
y.low = IAMs_SC_N2O[,c(quantile(SC_GHG,0.25)),by=c("Ds")]$V1,
y.mid = IAMs_SC_N2O[,c(quantile(SC_GHG,0.5)),by=c("Ds")]$V1,
y.high = IAMs_SC_N2O[,c(quantile(SC_GHG,0.75)),by=c("Ds")]$V1,
y.likelymax = IAMs_SC_N2O[,c(quantile(SC_GHG,0.833)),by=c("Ds")]$V1,
y.max = IAMs_SC_N2O[,c(quantile(SC_GHG,0.95)),by=c("Ds")]$V1)
IAMs_SC_N2O_climate_damage_quantile <- IAMs_SC_N2O[,c(mean(SC_GHG)),by=c("Ds","Climate_models","Damage_models")]
IAMs_SC_N2O_climate_damage_quantile <- IAMs_SC_N2O_climate_damage_quantile %>%
dplyr::mutate(y.min = IAMs_SC_N2O[,c(quantile(SC_GHG,0.05)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.likelymin = IAMs_SC_N2O[,c(quantile(SC_GHG,0.167)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.low = IAMs_SC_N2O[,c(quantile(SC_GHG,0.25)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.mid = IAMs_SC_N2O[,c(quantile(SC_GHG,0.5)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.mean = IAMs_SC_N2O[,c(mean(SC_GHG)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.high = IAMs_SC_N2O[,c(quantile(SC_GHG,0.75)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.likelymax = IAMs_SC_N2O[,c(quantile(SC_GHG,0.833)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.max = IAMs_SC_N2O[,c(quantile(SC_GHG,0.95)),by=c("Ds","Climate_models","Damage_models")]$V1)
Ds_target_3 = c("ds_3")
IAMs_SC_CH4_climate_damage_quantile_ds3 = IAMs_SC_CH4_climate_damage_quantile[IAMs_SC_CH4_climate_damage_quantile$Ds %in% Ds_target_3,]
IAMs_SC_N2O_climate_damage_quantile_ds3 = IAMs_SC_N2O_climate_damage_quantile[IAMs_SC_N2O_climate_damage_quantile$Ds %in% Ds_target_3,]
Ds_target_timevarying = c("ds_timevarying")
IAMs_SC_CH4_climate_damage_quantile_dstimevarying = IAMs_SC_CH4_climate_damage_quantile[IAMs_SC_CH4_climate_damage_quantile$Ds %in% Ds_target_timevarying,]
IAMs_SC_N2O_climate_damage_quantile_dstimevarying = IAMs_SC_N2O_climate_damage_quantile[IAMs_SC_N2O_climate_damage_quantile$Ds %in% Ds_target_timevarying,]
IAMs_SC_CH4_climate_damage_quantile_ds3
IAMs_SC_CH4_climate_damage_quantile_ds3
IAMs_SC_CH4_climate_damage_quantile_dstimevarying
IAMs_SC_N2O_climate_damage_quantile_dstimevarying
IAMs_SC_N2O_climate_damage_quantile_dss3
IAMs_SC_N2O_climate_damage_quantile_ds3
library("data.table")
library("ggplot2")
library(dplyr)
library(gridExtra)
library(ggpubr)
library(cowplot)
library(scales)
library(ggpattern)
library(matrixStats)
setwd("/Users/tianpeng/Desktop/nonCO2-cost/NCC_revise/Compute_SC_GHG");
run_time = 10000;
options(scipen = 9)  #科学计数法
# Dam_nolevel = c("BHM-lag0","BHM-lag5","DJO","KW","D-DICE","Howard","D-FUND","D-PAGE","Equally weighted")
# Dam_withlevel = c("BHM-lag0","BHM-lag5","DJO","KW","D-DICE","D-DICE-level","Howard","Howard-level","D-FUND","D-PAGE","Equally weighted")
# Dam_level = c("D-FUND","D-PAGE","KW")
Dam_nolevel = c("BHM-lag0","BHM-lag5","DJO","D-DICE","Howard","D-FUND","D-PAGE")
Dam_withlevel = c("BHM-lag0","BHM-lag5","DJO","D-DICE","D-DICE-level","Howard","Howard-level","D-FUND","D-PAGE")
Dam_level = c("D-FUND","D-PAGE")
Dam_hybrid = c("D-DICE","Howard")
Dam_growth = c("BHM-lag0","BHM-lag5","DJO")
Clim_SCMs = c("FAIR","MAGICC","Hector")
Clim_total = c(Clim_SCMs)
Ds_total = c("ds_1.5","ds_2","ds_3","ds_5","ds_timevarying")
Climate_num = length(Clim_total);
Damage_num = length(Dam_nolevel);
Ds_num = length(Ds_total);
ds_target = "ds_timevarying"
## SC_GHG from Fair model
SC_Fair_DJO_CO2 = as.matrix(fread("SC_Fair_climate/SC_Fair_DJO/ssp245/WSC_CO2_Fair_DJO.csv"));
SC_Fair_DJO_CH4 = as.matrix(fread("SC_Fair_climate/SC_Fair_DJO/ssp245/WSC_CH4_Fair_DJO.csv"));
SC_Fair_DJO_N2O = as.matrix(fread("SC_Fair_climate/SC_Fair_DJO/ssp245/WSC_N2O_Fair_DJO.csv"));
dim(SC_Fair_DJO_CO2) = c(run_time*Ds_num,1)
dim(SC_Fair_DJO_CH4) = c(run_time*Ds_num,1)
dim(SC_Fair_DJO_N2O) = c(run_time*Ds_num,1)
SC_Fair_BHM_lag0_CO2 = as.matrix(fread("SC_Fair_climate/SC_Fair_BHM/ssp245/lag0/WSC_CO2_Fair_BHM.csv"));
SC_Fair_BHM_lag0_CH4 = as.matrix(fread("SC_Fair_climate/SC_Fair_BHM/ssp245/lag0/WSC_CH4_Fair_BHM.csv"));
SC_Fair_BHM_lag0_N2O = as.matrix(fread("SC_Fair_climate/SC_Fair_BHM/ssp245/lag0/WSC_N2O_Fair_BHM.csv"));
dim(SC_Fair_BHM_lag0_CO2) = c(run_time*Ds_num,1)
dim(SC_Fair_BHM_lag0_CH4) = c(run_time*Ds_num,1)
dim(SC_Fair_BHM_lag0_N2O) = c(run_time*Ds_num,1)
SC_Fair_BHM_lag5_CO2 = as.matrix(fread("SC_Fair_climate/SC_Fair_BHM/ssp245/lag5/WSC_CO2_Fair_BHM.csv"));
SC_Fair_BHM_lag5_CH4 = as.matrix(fread("SC_Fair_climate/SC_Fair_BHM/ssp245/lag5/WSC_CH4_Fair_BHM.csv"));
SC_Fair_BHM_lag5_N2O = as.matrix(fread("SC_Fair_climate/SC_Fair_BHM/ssp245/lag5/WSC_N2O_Fair_BHM.csv"));
dim(SC_Fair_BHM_lag5_CO2) = c(run_time*Ds_num,1)
dim(SC_Fair_BHM_lag5_CH4) = c(run_time*Ds_num,1)
dim(SC_Fair_BHM_lag5_N2O) = c(run_time*Ds_num,1)
# SC_Fair_KW_CO2 = as.matrix(fread("SC_Fair_climate/SC_Fair_KW/ssp245/WSC_CO2_Fair_KW.csv"));
# SC_Fair_KW_CH4 = as.matrix(fread("SC_Fair_climate/SC_Fair_KW/ssp245/WSC_CH4_Fair_KW.csv"));
# SC_Fair_KW_N2O = as.matrix(fread("SC_Fair_climate/SC_Fair_KW/ssp245/WSC_N2O_Fair_KW.csv"));
#
# dim(SC_Fair_KW_CO2) = c(run_time*Ds_num,1)
# dim(SC_Fair_KW_CH4) = c(run_time*Ds_num,1)
# dim(SC_Fair_KW_N2O) = c(run_time*Ds_num,1)
SC_Fair_FUND_CO2 = as.matrix(fread("SC_Fair_climate/SC_Fair_FUND/ssp245/SC_CO2_Fair_FUND.csv"))*1.46;
SC_Fair_FUND_CH4 = as.matrix(fread("SC_Fair_climate/SC_Fair_FUND/ssp245/SC_CH4_Fair_FUND.csv"))*1.46;
SC_Fair_FUND_N2O = as.matrix(fread("SC_Fair_climate/SC_Fair_FUND/ssp245/SC_N2O_Fair_FUND.csv"))*1.46;
dim(SC_Fair_FUND_CO2) = c(run_time*Ds_num,1)
dim(SC_Fair_FUND_CH4) = c(run_time*Ds_num,1)
dim(SC_Fair_FUND_N2O) = c(run_time*Ds_num,1)
SC_Fair_PAGE_CO2 = as.matrix(fread("SC_Fair_climate/SC_Fair_PAGE/ssp245/SC_CO2_Fair_PAGE.csv"))*1.20;
SC_Fair_PAGE_CH4 = as.matrix(fread("SC_Fair_climate/SC_Fair_PAGE/ssp245/SC_CH4_Fair_PAGE.csv"))*1.20;
SC_Fair_PAGE_N2O = as.matrix(fread("SC_Fair_climate/SC_Fair_PAGE/ssp245/SC_N2O_Fair_PAGE.csv"))*1.20;
dim(SC_Fair_PAGE_CO2) = c(run_time*Ds_num,1)
dim(SC_Fair_PAGE_CH4) = c(run_time*Ds_num,1)
dim(SC_Fair_PAGE_N2O) = c(run_time*Ds_num,1)
SC_Fair_DICE_CO2 = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/ssp245/SC_CO2_total_Fair_DICE.csv"));
SC_Fair_DICE_CH4 = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/ssp245/SC_CH4_total_Fair_DICE.csv"));
SC_Fair_DICE_N2O = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/ssp245/SC_N2O_total_Fair_DICE.csv"));
dim(SC_Fair_DICE_CO2) = c(run_time*Ds_num,1)
dim(SC_Fair_DICE_CH4) = c(run_time*Ds_num,1)
dim(SC_Fair_DICE_N2O) = c(run_time*Ds_num,1)
SC_Fair_DICE_CO2_level = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/ssp245/SC_CO2_level_Fair_DICE.csv"));
SC_Fair_DICE_CH4_level = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/ssp245/SC_CH4_level_Fair_DICE.csv"));
SC_Fair_DICE_N2O_level = as.matrix(fread("SC_Fair_climate/SC_Fair_DICE/ssp245/SC_N2O_level_Fair_DICE.csv"));
dim(SC_Fair_DICE_CO2_level) = c(run_time*Ds_num,1)
dim(SC_Fair_DICE_CH4_level) = c(run_time*Ds_num,1)
dim(SC_Fair_DICE_N2O_level) = c(run_time*Ds_num,1)
SC_Fair_Howard_CO2 = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/ssp245/SC_CO2_total_Fair_Howard.csv"));
SC_Fair_Howard_CH4 = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/ssp245/SC_CH4_total_Fair_Howard.csv"));
SC_Fair_Howard_N2O = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/ssp245/SC_N2O_total_Fair_Howard.csv"));
dim(SC_Fair_Howard_CO2) = c(run_time*Ds_num,1)
dim(SC_Fair_Howard_CH4) = c(run_time*Ds_num,1)
dim(SC_Fair_Howard_N2O) = c(run_time*Ds_num,1)
SC_Fair_Howard_CO2_level = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/ssp245/SC_CO2_level_Fair_Howard.csv"));
SC_Fair_Howard_CH4_level = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/ssp245/SC_CH4_level_Fair_Howard.csv"));
SC_Fair_Howard_N2O_level = as.matrix(fread("SC_Fair_climate/SC_Fair_Howard/ssp245/SC_N2O_level_Fair_Howard.csv"));
dim(SC_Fair_Howard_CO2_level) = c(run_time*Ds_num,1)
dim(SC_Fair_Howard_CH4_level) = c(run_time*Ds_num,1)
dim(SC_Fair_Howard_N2O_level) = c(run_time*Ds_num,1)
## SC_GHG from MAGICC model
SC_MAGICC_DJO_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DJO/ssp245/WSC_CO2_MAGICC_DJO.csv"));
SC_MAGICC_DJO_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DJO/ssp245/WSC_CH4_MAGICC_DJO.csv"));
SC_MAGICC_DJO_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DJO/ssp245/WSC_N2O_MAGICC_DJO.csv"));
dim(SC_MAGICC_DJO_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DJO_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DJO_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_BHM_lag0_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/ssp245/lag0/WSC_CO2_MAGICC_BHM.csv"));
SC_MAGICC_BHM_lag0_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/ssp245/lag0/WSC_CH4_MAGICC_BHM.csv"));
SC_MAGICC_BHM_lag0_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/ssp245/lag0/WSC_N2O_MAGICC_BHM.csv"));
dim(SC_MAGICC_BHM_lag0_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_BHM_lag0_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_BHM_lag0_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_BHM_lag5_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/ssp245/lag5/WSC_CO2_MAGICC_BHM.csv"));
SC_MAGICC_BHM_lag5_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/ssp245/lag5/WSC_CH4_MAGICC_BHM.csv"));
SC_MAGICC_BHM_lag5_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_BHM/ssp245/lag5/WSC_N2O_MAGICC_BHM.csv"));
dim(SC_MAGICC_BHM_lag5_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_BHM_lag5_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_BHM_lag5_N2O) = c(run_time*Ds_num,1)
#
# SC_MAGICC_KW_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_KW/ssp245/WSC_CO2_MAGICC_KW.csv"));
# SC_MAGICC_KW_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_KW/ssp245/WSC_CH4_MAGICC_KW.csv"));
# SC_MAGICC_KW_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_KW/ssp245/WSC_N2O_MAGICC_KW.csv"));
#
# dim(SC_MAGICC_KW_CO2) = c(run_time*Ds_num,1)
# dim(SC_MAGICC_KW_CH4) = c(run_time*Ds_num,1)
# dim(SC_MAGICC_KW_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_FUND_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_FUND/ssp245/SC_CO2_MAGICC_FUND.csv"))*1.46;
SC_MAGICC_FUND_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_FUND/ssp245/SC_CH4_MAGICC_FUND.csv"))*1.46;
SC_MAGICC_FUND_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_FUND/ssp245/SC_N2O_MAGICC_FUND.csv"))*1.46;
dim(SC_MAGICC_FUND_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_FUND_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_FUND_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_PAGE_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_PAGE/ssp245/SC_CO2_MAGICC_PAGE.csv"))*1.20;
SC_MAGICC_PAGE_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_PAGE/ssp245/SC_CH4_MAGICC_PAGE.csv"))*1.20;
SC_MAGICC_PAGE_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_PAGE/ssp245/SC_N2O_MAGICC_PAGE.csv"))*1.20;
dim(SC_MAGICC_PAGE_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_PAGE_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_PAGE_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_DICE_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/ssp245/SC_CO2_total_MAGICC_DICE.csv"));
SC_MAGICC_DICE_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/ssp245/SC_CH4_total_MAGICC_DICE.csv"));
SC_MAGICC_DICE_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/ssp245/SC_N2O_total_MAGICC_DICE.csv"));
dim(SC_MAGICC_DICE_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DICE_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DICE_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_DICE_CO2_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/ssp245/SC_CO2_level_MAGICC_DICE.csv"));
SC_MAGICC_DICE_CH4_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/ssp245/SC_CH4_level_MAGICC_DICE.csv"));
SC_MAGICC_DICE_N2O_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_DICE/ssp245/SC_N2O_level_MAGICC_DICE.csv"));
dim(SC_MAGICC_DICE_CO2_level) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DICE_CH4_level) = c(run_time*Ds_num,1)
dim(SC_MAGICC_DICE_N2O_level) = c(run_time*Ds_num,1)
SC_MAGICC_Howard_CO2 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/ssp245/SC_CO2_total_MAGICC_Howard.csv"));
SC_MAGICC_Howard_CH4 = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/ssp245/SC_CH4_total_MAGICC_Howard.csv"));
SC_MAGICC_Howard_N2O = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/ssp245/SC_N2O_total_MAGICC_Howard.csv"));
dim(SC_MAGICC_Howard_CO2) = c(run_time*Ds_num,1)
dim(SC_MAGICC_Howard_CH4) = c(run_time*Ds_num,1)
dim(SC_MAGICC_Howard_N2O) = c(run_time*Ds_num,1)
SC_MAGICC_Howard_CO2_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/ssp245/SC_CO2_level_MAGICC_Howard.csv"));
SC_MAGICC_Howard_CH4_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/ssp245/SC_CH4_level_MAGICC_Howard.csv"));
SC_MAGICC_Howard_N2O_level = as.matrix(fread("SC_MAGICC_climate/SC_MAGICC_Howard/ssp245/SC_N2O_level_MAGICC_Howard.csv"));
dim(SC_MAGICC_Howard_CO2_level) = c(run_time*Ds_num,1)
dim(SC_MAGICC_Howard_CH4_level) = c(run_time*Ds_num,1)
dim(SC_MAGICC_Howard_N2O_level) = c(run_time*Ds_num,1)
## SC_GHG from Hector model
SC_Hector_DJO_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_DJO/ssp245/WSC_CO2_Hector_DJO.csv"));
SC_Hector_DJO_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_DJO/ssp245/WSC_CH4_Hector_DJO.csv"));
SC_Hector_DJO_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_DJO/ssp245/WSC_N2O_Hector_DJO.csv"));
dim(SC_Hector_DJO_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_DJO_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_DJO_N2O) = c(run_time*Ds_num,1)
SC_Hector_BHM_lag0_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/ssp245/lag0/WSC_CO2_Hector_BHM.csv"));
SC_Hector_BHM_lag0_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/ssp245/lag0/WSC_CH4_Hector_BHM.csv"));
SC_Hector_BHM_lag0_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/ssp245/lag0/WSC_N2O_Hector_BHM.csv"));
dim(SC_Hector_BHM_lag0_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_BHM_lag0_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_BHM_lag0_N2O) = c(run_time*Ds_num,1)
SC_Hector_BHM_lag5_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/ssp245/lag5/WSC_CO2_Hector_BHM.csv"));
SC_Hector_BHM_lag5_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/ssp245/lag5/WSC_CH4_Hector_BHM.csv"));
SC_Hector_BHM_lag5_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_BHM/ssp245/lag5/WSC_N2O_Hector_BHM.csv"));
dim(SC_Hector_BHM_lag5_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_BHM_lag5_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_BHM_lag5_N2O) = c(run_time*Ds_num,1)
#
# SC_Hector_KW_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_KW/ssp245/WSC_CO2_Hector_KW.csv"));
# SC_Hector_KW_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_KW/ssp245/WSC_CH4_Hector_KW.csv"));
# SC_Hector_KW_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_KW/ssp245/WSC_N2O_Hector_KW.csv"));
#
# dim(SC_Hector_KW_CO2) = c(run_time*Ds_num,1)
# dim(SC_Hector_KW_CH4) = c(run_time*Ds_num,1)
# dim(SC_Hector_KW_N2O) = c(run_time*Ds_num,1)
SC_Hector_FUND_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_FUND/ssp245/SC_CO2_Hector_FUND.csv"))*1.46;
SC_Hector_FUND_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_FUND/ssp245/SC_CH4_Hector_FUND.csv"))*1.46;
SC_Hector_FUND_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_FUND/ssp245/SC_N2O_Hector_FUND.csv"))*1.46;
dim(SC_Hector_FUND_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_FUND_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_FUND_N2O) = c(run_time*Ds_num,1)
SC_Hector_PAGE_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_PAGE/ssp245/SC_CO2_Hector_PAGE.csv"))*1.20;
SC_Hector_PAGE_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_PAGE/ssp245/SC_CH4_Hector_PAGE.csv"))*1.20;
SC_Hector_PAGE_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_PAGE/ssp245/SC_N2O_Hector_PAGE.csv"))*1.20;
dim(SC_Hector_PAGE_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_PAGE_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_PAGE_N2O) = c(run_time*Ds_num,1)
SC_Hector_DICE_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/ssp245/SC_CO2_total_Hector_DICE.csv"));
SC_Hector_DICE_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/ssp245/SC_CH4_total_Hector_DICE.csv"));
SC_Hector_DICE_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/ssp245/SC_N2O_total_Hector_DICE.csv"));
dim(SC_Hector_DICE_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_DICE_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_DICE_N2O) = c(run_time*Ds_num,1)
SC_Hector_DICE_CO2_level = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/ssp245/SC_CO2_level_Hector_DICE.csv"));
SC_Hector_DICE_CH4_level = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/ssp245/SC_CH4_level_Hector_DICE.csv"));
SC_Hector_DICE_N2O_level = as.matrix(fread("SC_Hector_climate/SC_Hector_DICE/ssp245/SC_N2O_level_Hector_DICE.csv"));
dim(SC_Hector_DICE_CO2_level) = c(run_time*Ds_num,1)
dim(SC_Hector_DICE_CH4_level) = c(run_time*Ds_num,1)
dim(SC_Hector_DICE_N2O_level) = c(run_time*Ds_num,1)
SC_Hector_Howard_CO2 = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/ssp245/SC_CO2_total_Hector_Howard.csv"));
SC_Hector_Howard_CH4 = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/ssp245/SC_CH4_total_Hector_Howard.csv"));
SC_Hector_Howard_N2O = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/ssp245/SC_N2O_total_Hector_Howard.csv"));
dim(SC_Hector_Howard_CO2) = c(run_time*Ds_num,1)
dim(SC_Hector_Howard_CH4) = c(run_time*Ds_num,1)
dim(SC_Hector_Howard_N2O) = c(run_time*Ds_num,1)
SC_Hector_Howard_CO2_level = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/ssp245/SC_CO2_level_Hector_Howard.csv"));
SC_Hector_Howard_CH4_level = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/ssp245/SC_CH4_level_Hector_Howard.csv"));
SC_Hector_Howard_N2O_level = as.matrix(fread("SC_Hector_climate/SC_Hector_Howard/ssp245/SC_N2O_level_Hector_Howard.csv"));
dim(SC_Hector_Howard_CO2_level) = c(run_time*Ds_num,1)
dim(SC_Hector_Howard_CH4_level) = c(run_time*Ds_num,1)
dim(SC_Hector_Howard_N2O_level) = c(run_time*Ds_num,1)
## Construct the data frame for methane
IAMs_SC_CH4 = matrix(nrow = run_time*Climate_num*Damage_num*Ds_num,ncol = 4);
IAMs_SC_CH4[,1] = rep(Clim_total,each = run_time*Damage_num*Ds_num);
IAMs_SC_CH4[,2] = rep(rep(Dam_nolevel[1:Damage_num],each = run_time*Ds_num),Climate_num);
IAMs_SC_CH4[,3] = rep(rep(Ds_total,each = run_time),Climate_num*Damage_num);
IAMs_SC_CH4[,4] = c(SC_Fair_BHM_lag0_CH4,SC_Fair_BHM_lag5_CH4,SC_Fair_DJO_CH4,SC_Fair_DICE_CH4,SC_Fair_Howard_CH4,SC_Fair_FUND_CH4,SC_Fair_PAGE_CH4,
SC_MAGICC_BHM_lag0_CH4,SC_MAGICC_BHM_lag5_CH4,SC_MAGICC_DJO_CH4,SC_MAGICC_DICE_CH4,SC_MAGICC_Howard_CH4,SC_MAGICC_FUND_CH4,SC_MAGICC_PAGE_CH4,
SC_Hector_BHM_lag0_CH4,SC_Hector_BHM_lag5_CH4,SC_Hector_DJO_CH4,SC_Hector_DICE_CH4,SC_Hector_Howard_CH4,SC_Hector_FUND_CH4,SC_Hector_PAGE_CH4);
IAMs_SC_CH4 = as.data.frame(IAMs_SC_CH4)
colnames(IAMs_SC_CH4) = c("Climate_models","Damage_models","Ds","SC_GHG");
IAMs_SC_CH4$SC_GHG = as.numeric(as.character(IAMs_SC_CH4$SC_GHG))
IAMs_SC_CH4=as.data.table(IAMs_SC_CH4);
IAMs_SC_CH4_quantile <- IAMs_SC_CH4[,c(mean(SC_GHG)),by=c("Ds")]
IAMs_SC_CH4_quantile <- IAMs_SC_CH4_quantile %>%
dplyr::mutate(y.min = IAMs_SC_CH4[,c(quantile(SC_GHG,0.05)),by=c("Ds")]$V1,
y.likelymin = IAMs_SC_CH4[,c(quantile(SC_GHG,0.167)),by=c("Ds")]$V1,
y.low = IAMs_SC_CH4[,c(quantile(SC_GHG,0.25)),by=c("Ds")]$V1,
y.mid = IAMs_SC_CH4[,c(quantile(SC_GHG,0.5)),by=c("Ds")]$V1,
y.high = IAMs_SC_CH4[,c(quantile(SC_GHG,0.75)),by=c("Ds")]$V1,
y.likelymax = IAMs_SC_CH4[,c(quantile(SC_GHG,0.833)),by=c("Ds")]$V1,
y.max = IAMs_SC_CH4[,c(quantile(SC_GHG,0.95)),by=c("Ds")]$V1)
IAMs_SC_CH4_climate_damage_quantile <- IAMs_SC_CH4[,c(mean(SC_GHG)),by=c("Ds","Climate_models","Damage_models")]
IAMs_SC_CH4_climate_damage_quantile <- IAMs_SC_CH4_climate_damage_quantile %>%
dplyr::mutate(y.min = IAMs_SC_CH4[,c(quantile(SC_GHG,0.05)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.likelymin = IAMs_SC_CH4[,c(quantile(SC_GHG,0.167)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.low = IAMs_SC_CH4[,c(quantile(SC_GHG,0.25)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.mid = IAMs_SC_CH4[,c(quantile(SC_GHG,0.5)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.mean = IAMs_SC_CH4[,c(mean(SC_GHG)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.high = IAMs_SC_CH4[,c(quantile(SC_GHG,0.75)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.likelymax = IAMs_SC_CH4[,c(quantile(SC_GHG,0.833)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.max = IAMs_SC_CH4[,c(quantile(SC_GHG,0.95)),by=c("Ds","Climate_models","Damage_models")]$V1)
## Construct the data frame for N2O
IAMs_SC_N2O = matrix(nrow = run_time*Climate_num*Damage_num*Ds_num,ncol = 4);
IAMs_SC_N2O[,1] = rep(Clim_total,each = run_time*Damage_num*Ds_num);
IAMs_SC_N2O[,2] = rep(rep(Dam_nolevel[1:Damage_num],each = run_time*Ds_num),Climate_num);
IAMs_SC_N2O[,3] = rep(rep(Ds_total,each = run_time),Climate_num*Damage_num);
IAMs_SC_N2O[,4] = c(SC_Fair_BHM_lag0_N2O,SC_Fair_BHM_lag5_N2O,SC_Fair_DJO_N2O,SC_Fair_DICE_N2O,SC_Fair_Howard_N2O,SC_Fair_FUND_N2O,SC_Fair_PAGE_N2O,
SC_MAGICC_BHM_lag0_N2O,SC_MAGICC_BHM_lag5_N2O,SC_MAGICC_DJO_N2O,SC_MAGICC_DICE_N2O,SC_MAGICC_Howard_N2O,SC_MAGICC_FUND_N2O,SC_MAGICC_PAGE_N2O,
SC_Hector_BHM_lag0_N2O,SC_Hector_BHM_lag5_N2O,SC_Hector_DJO_N2O,SC_Hector_DICE_N2O,SC_Hector_Howard_N2O,SC_Hector_FUND_N2O,SC_Hector_PAGE_N2O);
IAMs_SC_N2O = as.data.frame(IAMs_SC_N2O)
colnames(IAMs_SC_N2O) = c("Climate_models","Damage_models","Ds","SC_GHG");
IAMs_SC_N2O$SC_GHG = as.numeric(as.character(IAMs_SC_N2O$SC_GHG))
IAMs_SC_N2O=as.data.table(IAMs_SC_N2O);
IAMs_SC_N2O_quantile <- IAMs_SC_N2O[,c(mean(SC_GHG)),by=c("Ds")]
IAMs_SC_N2O_quantile <- IAMs_SC_N2O_quantile %>%
dplyr::mutate(y.min = IAMs_SC_N2O[,c(quantile(SC_GHG,0.05)),by=c("Ds")]$V1,
y.likelymin = IAMs_SC_N2O[,c(quantile(SC_GHG,0.167)),by=c("Ds")]$V1,
y.low = IAMs_SC_N2O[,c(quantile(SC_GHG,0.25)),by=c("Ds")]$V1,
y.mid = IAMs_SC_N2O[,c(quantile(SC_GHG,0.5)),by=c("Ds")]$V1,
y.high = IAMs_SC_N2O[,c(quantile(SC_GHG,0.75)),by=c("Ds")]$V1,
y.likelymax = IAMs_SC_N2O[,c(quantile(SC_GHG,0.833)),by=c("Ds")]$V1,
y.max = IAMs_SC_N2O[,c(quantile(SC_GHG,0.95)),by=c("Ds")]$V1)
IAMs_SC_N2O_climate_damage_quantile <- IAMs_SC_N2O[,c(mean(SC_GHG)),by=c("Ds","Climate_models","Damage_models")]
IAMs_SC_N2O_climate_damage_quantile <- IAMs_SC_N2O_climate_damage_quantile %>%
dplyr::mutate(y.min = IAMs_SC_N2O[,c(quantile(SC_GHG,0.05)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.likelymin = IAMs_SC_N2O[,c(quantile(SC_GHG,0.167)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.low = IAMs_SC_N2O[,c(quantile(SC_GHG,0.25)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.mid = IAMs_SC_N2O[,c(quantile(SC_GHG,0.5)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.mean = IAMs_SC_N2O[,c(mean(SC_GHG)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.high = IAMs_SC_N2O[,c(quantile(SC_GHG,0.75)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.likelymax = IAMs_SC_N2O[,c(quantile(SC_GHG,0.833)),by=c("Ds","Climate_models","Damage_models")]$V1,
y.max = IAMs_SC_N2O[,c(quantile(SC_GHG,0.95)),by=c("Ds","Climate_models","Damage_models")]$V1)
Ds_target_3 = c("ds_3")
IAMs_SC_CH4_climate_damage_quantile_ds3 = IAMs_SC_CH4_climate_damage_quantile[IAMs_SC_CH4_climate_damage_quantile$Ds %in% Ds_target_3,]
IAMs_SC_N2O_climate_damage_quantile_ds3 = IAMs_SC_N2O_climate_damage_quantile[IAMs_SC_N2O_climate_damage_quantile$Ds %in% Ds_target_3,]
Ds_target_timevarying = c("ds_timevarying")
IAMs_SC_CH4_climate_damage_quantile_dstimevarying = IAMs_SC_CH4_climate_damage_quantile[IAMs_SC_CH4_climate_damage_quantile$Ds %in% Ds_target_timevarying,]
IAMs_SC_N2O_climate_damage_quantile_dstimevarying = IAMs_SC_N2O_climate_damage_quantile[IAMs_SC_N2O_climate_damage_quantile$Ds %in% Ds_target_timevarying,]
IAMs_SC_CH4_climate_damage_quantile_dstimevarying
IAMs_SC_CH4_climate_damage_quantile_ds3
IAMs_SC_N2O_climate_damage_quantile_dstimevarying
IAMs_SC_N2O_climate_damage_quantile_ds3
